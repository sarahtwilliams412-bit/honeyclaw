# HoneyClaw Helm Chart - Default Values
#
# Override per environment with:
#   helm install honeyclaw ./deploy/kubernetes/helm/honeyclaw -f values-prod.yaml

# -- Global settings
nameOverride: ""
fullnameOverride: ""

global:
  environment: production
  honeypotId: honeyclaw

# -- Honeypot template to deploy
template: basic-ssh
# Options: basic-ssh, fake-api, enterprise-sim

# -- Container image
image:
  repository: honeyclaw/basic-ssh
  tag: latest
  pullPolicy: Always

# -- Number of replicas
replicaCount: 1

# -- Service account
serviceAccount:
  create: true
  name: ""
  annotations: {}

# -- Pod security context (restricted)
podSecurityContext:
  runAsNonRoot: true
  runAsUser: 1000
  runAsGroup: 1000
  fsGroup: 1000
  seccompProfile:
    type: RuntimeDefault

# -- Container security context
securityContext:
  allowPrivilegeEscalation: false
  readOnlyRootFilesystem: true
  capabilities:
    drop:
      - ALL

# Pod security settings
podSecurity:
  runAsNonRoot: false
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  pidsLimit: 100

# -- Service configuration
service:
  type: LoadBalancer
  ports:
    # basic-ssh
    - name: ssh
      port: 2222
      targetPort: 8022
      protocol: TCP

# -- Resource limits
resources:
  limits:
    cpu: 500m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 128Mi

# -- Environment variables
env:
  PORT: "8022"
  SSH_BANNER: "OpenSSH_8.9p1 Ubuntu-3ubuntu0.6"
  LOG_PATH: "/data/logs/honeypot.json"
  RATELIMIT_ENABLED: "true"
  RATELIMIT_CONN_PER_MIN: "20"
  RATELIMIT_AUTH_PER_HOUR: "200"

# -- Secrets (provided via --set or external secret manager)
secrets: {}
  # MESH_TOKEN: ""
  # ALERT_WEBHOOK_URL: ""

# -- Volume mounts
persistence:
  enabled: true
  storageClass: ""
  size: 1Gi
  accessModes:
    - ReadWriteOnce

# Health checks
healthCheck:
  port: 9090
  path: /health
  initialDelaySeconds: 30
  periodSeconds: 30
  timeoutSeconds: 5
  failureThreshold: 3

# -- Network policy (strict egress control)
networkPolicy:
  enabled: true
  # Allow egress only to these CIDRs (e.g., logging service)
  egressCIDRs: []
  # Allow egress to these DNS names
  egressDNS: true
  # Custom egress rules
  egressRules:
    - to: []
      ports:
        - port: 53
          protocol: UDP
        - port: 443
          protocol: TCP

# -- Horizontal Pod Autoscaler
autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 5
  targetCPUUtilization: 70
  targetCPUUtilizationPercentage: 70

# -- Pod rotation CronJob (automated rebuild cycle)
rotation:
  enabled: true
  # Cron schedule: every 24 hours at 3 AM UTC
  schedule: "0 3 * * *"
  intervalHours: 24
  # How many rotation history records to keep
  successfulJobsHistoryLimit: 3
  failedJobsHistoryLimit: 3

# -- Pod anti-affinity (spread across nodes)
podAntiAffinity:
  enabled: true

# -- Node selector
nodeSelector: {}

# -- Tolerations
tolerations: []

# Monitoring
monitoring:
  enabled: false
  serviceMonitor: false

# Logging
logging:
  s3Bucket: ""
  s3Prefix: "logs/"
  siemEndpoint: ""
  siemPort: 514
